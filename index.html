<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Light & Shadow Simulation - SLS</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --light-ray: #f1c40f;
            --bg: #f8fafc;
        }
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background-color: var(--bg);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: var(--primary);
            margin: 0;
        }
        .container {
            width: 850px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            padding: 30px;
            border: 1px solid #e2e8f0;
        }
        h2 { margin-top: 0; color: var(--primary); text-align: center; }
        
        #sim-stage {
            width: 100%;
            height: 350px;
            background: #ffffff;
            border: 2px solid #cbd5e1;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            margin-bottom: 20px;
        }

        /* SVG Overlay for Rays */
        #ray-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 2;
        }

        .label {
            position: absolute;
            font-weight: bold;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #94a3b8;
            pointer-events: none;
        }

        /* Equipment Styles */
        #torch-container {
            position: absolute;
            left: 20px;
            top: 145px; /* Adjusted to center vertically (Stage 350 / 2 - torch 60 / 2) */
            width: 80px;
            z-index: 10;
        }
        #cone-container {
            position: absolute;
            top: 150px; /* Center is at 175px */
            width: 50px;
            height: 50px;
            cursor: ew-resize;
            z-index: 5;
        }
        #screen-container {
            position: absolute;
            right: 0;
            top: 0;
            width: 150px;
            height: 100%;
            background: #f1f5f9;
            border-left: 6px solid #475569;
            display: flex;
            justify-content: center;
            align-items: center; /* Ensures shadow div stays vertically centered */
            z-index: 1;
        }
        #shadow {
            background: rgba(15, 23, 42, 0.9);
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
            transition: none;
            width: 100%; /* Width matches the container width for scaling */
        }

        /* Controls */
        .dashboard {
            display: grid;
            grid-template-columns: 1.5fr 1fr;
            gap: 20px;
            border-top: 2px solid #f1f5f9;
            padding-top: 20px;
        }
        .slider-box label { font-weight: 600; display: block; margin-bottom: 10px; }
        input[type=range] {
            width: 100%;
            cursor: pointer;
            accent-color: var(--accent);
        }
        .data-display {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        .stat-card {
            background: #f8fafc;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }
        .stat-label { font-size: 10px; color: #64748b; display: block; margin-bottom: 4px; }
        .stat-value { font-size: 18px; font-weight: bold; color: var(--accent); }

        .note {
            grid-column: span 2;
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 12px;
            font-size: 14px;
            margin-top: 10px;
            border-radius: 4px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>Light and Shadows Simulation</h2>
        
        <div id="sim-stage">
            <div class="label" style="left: 20px; top: 120px;">Light Source</div>
            <div class="label" style="right: 50px; top: 20px;">Screen</div>

            <!-- SVG for Light Rays -->
            <svg id="ray-canvas">
                <line id="ray-top" x1="0" y1="0" x2="0" y2="0" stroke="#f1c40f" stroke-width="2" stroke-dasharray="4" />
                <line id="ray-bottom" x1="0" y1="0" x2="0" y2="0" stroke="#f1c40f" stroke-width="2" stroke-dasharray="4" />
                <defs>
                    <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse">
                        <path d="M 0 0 L 10 5 L 0 10 z" fill="#f1c40f" />
                    </marker>
                </defs>
            </svg>
            
            <div id="torch-container">
                <svg viewBox="0 0 100 60">
                    <rect x="0" y="20" width="60" height="20" fill="#475569" rx="2" />
                    <path d="M60 15 L90 5 L90 55 L60 45 Z" fill="#94a3b8" />
                    <circle cx="90" cy="30" r="10" fill="#fde047" />
                </svg>
            </div>

            <div id="cone-container">
                <svg viewBox="0 0 100 100" width="50" height="50">
                    <path d="M50 5 L100 95 L0 95 Z" fill="#d97706" />
                    <ellipse cx="50" cy="95" rx="50" ry="8" fill="#92400e" />
                </svg>
                <div class="label" style="top: 55px; width: 100px; left: -25px; text-align: center;">Wooden Cone</div>
            </div>

            <div id="screen-container">
                <div id="shadow"></div>
            </div>
        </div>

        <div class="dashboard">
            <div class="slider-box">
                <label>Move the Wooden Cone Position:</label>
                <input type="range" id="posSlider" min="150" max="630" value="550">
            </div>

            <div class="data-display">
                <div class="stat-card">
                    <span class="stat-label">From Source</span>
                    <span class="stat-value"><span id="valSource">0</span> cm</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">From Screen</span>
                    <span class="stat-value"><span id="valScreen">0</span> cm</span>
                </div>
                <div class="stat-card">
                    <span class="stat-label">Shadow Height</span>
                    <span class="stat-value"><span id="valHeight">0</span> cm</span>
                </div>
            </div>

            <div class="note">
                <strong>Pedagogy Note:</strong> Observe how the length of shadow changes as the cone moves closer to the torch. The yellow rays show how light travels in straight lines from the source to the screen.
            </div>
        </div>
    </div>

    <script>
        const slider = document.getElementById('posSlider');
        const cone = document.getElementById('cone-container');
        const shadow = document.getElementById('shadow');
        const rayTop = document.getElementById('ray-top');
        const rayBottom = document.getElementById('ray-bottom');
        
        const valSource = document.getElementById('valSource');
        const valScreen = document.getElementById('valScreen');
        const valHeight = document.getElementById('valHeight');

        // Central axis logic
        const centerY = 175; // Middle of 350px stage
        const torchX = 110;  // Front of the bulb
        const torchY = 175;  // Torch bulb is centered exactly at 175
        const screenX = 700; // Left edge of the screen

        function update() {
            const currentX = parseInt(slider.value);
            cone.style.left = currentX + 'px';
            
            // Distances
            const dSource = currentX - torchX;
            const dScreen = screenX - currentX;
            
            // Cone points relative to torch center (y=175)
            // The cone is 50px tall, so top is 25 above center, bottom is 25 below center
            const coneTopY = 150; 
            const coneBottomY = 200;

            // Calculate Rays and Projections
            // Slope formula: m = (y_cone - y_torch) / (x_cone - x_torch)
            const mTop = (coneTopY - torchY) / (currentX - torchX);
            const mBottom = (coneBottomY - torchY) / (currentX - torchX);

            // Calculate where rays hit the screen (x = screenX)
            const shadowTopY = torchY + mTop * (screenX - torchX);
            const shadowBottomY = torchY + mBottom * (screenX - torchX);

            // The absolute shadow height on the screen
            const shadowHeight = shadowBottomY - shadowTopY;
            
            // Update shadow visual
            shadow.style.height = shadowHeight + 'px';
            shadow.style.width = shadowHeight + 'px';

            // Align Rays
            rayTop.setAttribute('x1', torchX);
            rayTop.setAttribute('y1', torchY);
            rayTop.setAttribute('x2', screenX);
            rayTop.setAttribute('y2', shadowTopY);
            rayTop.setAttribute('marker-end', 'url(#arrow)');

            rayBottom.setAttribute('x1', torchX);
            rayBottom.setAttribute('y1', torchY);
            rayBottom.setAttribute('x2', screenX);
            rayBottom.setAttribute('y2', shadowBottomY);
            rayBottom.setAttribute('marker-end', 'url(#arrow)');

            // Update Labels
            valSource.innerText = Math.round(dSource / 5);
            valScreen.innerText = Math.round(dScreen / 5);
            valHeight.innerText = Math.round(shadowHeight / 5);
        }

        slider.addEventListener('input', update);
        window.onload = update;
    </script>
</body>
</html>